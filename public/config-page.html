<!DOCTYPE html>
<html lang="en">

<head>
  <script type="text/javascript" src="https://connect-cdn.atl-paas.net/all.js"></script>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-114996686-1"></script>
  <script type="text/javascript" src="js/google-analytics.js?version=2022.01"></script>
  <script type="text/javascript" src="js/demo/resources.js?version=2022.08"></script>

  <title>Configuration</title>
  <script>
    async function init() {
      const data = await getConsent();
      document.getElementById('upgrade-consent').checked = data.value;
    }

    async function saveConsent() {
      const value = document.getElementById('upgrade-consent').checked;
      console.log(value);
      await updateConsent(value);
    }

    async function getConsent() {
      const url = `/rest/atlassian-connect/1/addons/${addonKey()}/properties/upgrade-consent`;
      const response = await AP.request({ type: 'GET', url });
      return response.body && JSON.parse(response.body);
    }

    async function updateConsent(value) {
      const url = `/rest/atlassian-connect/1/addons/${addonKey()}/properties/upgrade-consent`;
      const response = await AP.request({ type: 'PUT', contentType: 'application/json', data: JSON.stringify(value), url });
      return response.body && JSON.parse(response.body);
    }
  </script>

  <script type="text/javascript" src="js/util.js" onload="init()"></script>

</head>

<body>
  <H1>Configuration</H1>
  <label for="upgrade-consent">I consent to upgrade all ZenUML Lite macros to Full</label><br>
  <input type="checkbox" id="upgrade-consent" name="Upgrade" onclick="saveConsent()">
</body>

</html>